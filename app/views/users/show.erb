<h1> Welcome, <%= @user.name %>! </h1>

<div>
  <button> <%= link_to "Edit User", edit_user_path(@user) %> </button>
</div>
<br>
<div>
  <% if flash[:messages] %>
    <%= flash[:messages] %>
  <% end %>
</div>
<br>
<div>
  <button><h3> <%= link_to "Browse Wellness Posts", posts_path %> </h3></button>
  <button><h3> <%= link_to "Create a New Wellness Post", new_post_path %> </h3></button>
  <button><h3> <%= link_to "Set a New Intention", new_intention_path %> </h3></button>
</div>

<h2>My Wellness Intentions:</h2>

<div>
  <% @user.intentions.each do |intention| %>
   <%= intention.name %>: <%= pluralize(intention.posts_count, 'Post') %><br>
    <% end %>
  <br>
</div>

<% @all_intentions.each do |intention_group| %>
  <% if intention_group == @incomplete_intentions %>
    <h2><%= 'Incomplete Intentions' %></h2>
  <% else %>
    <h2><%= 'Complete Intentions' %></h2>
  <% end %>

  <% intention_group.each do |intention| %>
   <h3><%= intention.name %></h3>
   <h5> <%= intention.complete == true ? 'COMPLETE' : 'INCOMPLETE' %> </h5>

   <%= form_for intention, method: 'patch', url: change_intention_status_path(intention) do |f| %>
     <% if intention.complete == false %>
      <%= f.submit 'Mark as Complete' %>
     <% else %>
      <%= f.submit 'Mark as Incomplete' %>
    <% end %>
   <% end %>

    <%intention.posts.each do |post| %><br>
      <%= post.comment %><br>
      <%=link_to post.url %><br>

      <% @user_post = UserPost.find_by(user_id: session[:user_id], post_id: post.id, intention_id: intention.id) %>
      <%= form_for post, method: 'delete', url: user_post_path(@user_post) do |f| %>
        <%= f.submit 'Remove Post From Intention'%>
      <% end %>

    <% end %>

    <p><button><%= link_to 'Edit Intention', edit_intention_path(intention) %></button></p>
  <% end %>

<% end %>
